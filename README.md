# EventQue

> A type-safe, async-friendly, queue-based event emitter for Node.js and TypeScript.

[![npm](https://img.shields.io/npm/v/eventque.svg)](https://www.npmjs.com/package/eventque)
[![License](https://img.shields.io/badge/license-MIT-green.svg)](LICENSE)
[![Docs](https://img.shields.io/badge/docs-typedoc-blue)](https://IsamuSugi.github.io/eventque/)

---

**EventQue** is a fully type-safe, Promise-based event emitter designed for Node.js and TypeScript.  
It supports queued event emission with ordered processing, parallel or sequential listener execution, timeout control, and AbortSignal cancellation.

---

## ğŸš€ Features

- âœ… Type-safe event and payload definitions
- âœ… Async emit with Promise results
- âœ… Queueing for ordered event handling
- âœ… Parallel or sequential listener execution
- âœ… Stop-on-error mode
- âœ… Per-listener timeout with AbortSignal support
- âœ… Per-event default configuration
- âœ… Fully compatible with Node.js EventEmitter API (`on`, `once`, `off`)

---

## ğŸ“š Documentation

ğŸ‘‰ **[Full API Docs (TypeDoc)](https://IsamuSugi.github.io/eventque/)**

Automatically generated using [TypeDoc](https://typedoc.org/).

---

## ğŸ“¦ Installation

```bash
npm install eventque
```

---

## ğŸ› ï¸ Basic Usage

### 1ï¸âƒ£ Define your event map

```typescript
interface MyEvents {
  log: [string]
  compute: [number, number]
}
```

---

### 2ï¸âƒ£ Create an EventQue instance

```typescript
import { EventQue } from 'eventque'

const emitter = new EventQue<MyEvents>({
  defaultOptions: {
    parallel: false,
    timeoutMs: 2000,
  },
  perEventOptions: {
    compute: {
      parallel: true,
      timeoutMs: 5000,
    },
  },
})
```

---

### 3ï¸âƒ£ Register listeners

```typescript
emitter.on('log', (message, signal) => {
  if (signal.aborted) return
  console.log('Log:', message)
})

emitter.once('compute', async (a, b, signal) => {
  if (signal.aborted) throw new Error('Cancelled')
  await new Promise((res) => setTimeout(res, 1000))
  return a + b
})
```

---

### 4ï¸âƒ£ Emit events

```typescript
await emitter.emitAsync('log', 'Hello EventQue!')

const results = await emitter.emitAsync('compute', 5, 7)
console.log('Compute Results:', results)
```

---

## âš™ï¸ EmitOptions

| Option        | Type    | Description                              |
| ------------- | ------- | ---------------------------------------- |
| `parallel`    | boolean | Whether to run all listeners in parallel |
| `stopOnError` | boolean | Stop execution on first error            |
| `timeoutMs`   | number  | Per-listener timeout in milliseconds     |

---

## ğŸ§© Example Project Structure

```
eventque/
â”œâ”€â”€ src/
â”‚   â””â”€â”€ EventQue.ts
â”œâ”€â”€ test/
â”‚   â””â”€â”€ EventQue.test.ts
â”œâ”€â”€ docs/                  â† Generated by TypeDoc
â”‚   â”œâ”€â”€ index.html
â”‚   â””â”€â”€ ...
â”œâ”€â”€ package.json
â””â”€â”€ README.md
```

âœ… Generate docs:

```bash
npm run docs
```

âœ… Preview locally:

```bash
npx http-server ./docs
```

âœ… GitHub Pages example:

```
https://IsamuSugi.github.io/eventque/
```

---

## ğŸ¤– GitHub Actions CI/CD Example

Use `.github/workflows/gh-pages.yml`:

```yaml
name: Deploy Docs

on:
  push:
    branches:
      - main

permissions:
  contents: write

jobs:
  build-and-deploy:
    runs-on: ubuntu-latest

    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-node@v4
        with:
          node-version: '20'
      - run: npm install
      - run: npm run docs
      - uses: peaceiris/actions-gh-pages@v3
        with:
          github_token: ${{ secrets.GITHUB_TOKEN }}
          publish_dir: ./docs
```

---

## ğŸ“œ License

MIT

---

## ğŸ’¡ Author

Isamu Sugiura / GitHub: [https://github.com/isamuSugi]

---

## ğŸ™ Contributing

Pull requests are welcome!
For major changes, please open an issue first to discuss what you would like to change.

---
